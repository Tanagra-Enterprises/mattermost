#!/bin/bash

# claude - Enter claude-code container, cd to workspace, and start Claude Code CLI
# Usage: ./claude

docker stop claude

# Read version files - error if they don't exist
if [ ! -f .nvmrc ]; then
    echo "Error: .nvmrc file not found"
    exit 1
fi

if [ ! -f server/.go-version ]; then
    echo "Error: server/.go-version file not found"
    exit 1
fi

NODE_VERSION=$(cat .nvmrc)
GO_VERSION=$(cat server/.go-version)

docker build -t claude-container \
    --build-arg NODE_VERSION="$NODE_VERSION" \
    --build-arg GO_VERSION="$GO_VERSION" \
    -f .claude/Dockerfile .
# Clear the terminal
clear
# Run the claude container
docker run -it --rm \
    --name claude \
    -v "$(pwd):/workspace" \
    -w /workspace \
    -e TZ="${TZ:-UTC}" \
    claude-container \
    claude